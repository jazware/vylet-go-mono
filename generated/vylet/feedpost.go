// Code generated by cmd/lexgen (see Makefile's lexgen); DO NOT EDIT.

// Lexicon schema: app.vylet.feed.post

package vylet

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io"

	comatproto "github.com/bluesky-social/indigo/api/atproto"
	lexutil "github.com/bluesky-social/indigo/lex/util"
	cbg "github.com/whyrusleeping/cbor-gen"
)

func init() {
	lexutil.RegisterType("app.vylet.feed.post", &FeedPost{})
}

type FeedPost struct {
	LexiconTypeID string `json:"$type" cborgen:"$type,const=app.vylet.feed.post"`
	// caption: The text that corresponds to the post's media.
	Caption *string `json:"caption,omitempty" cborgen:"caption,omitempty"`
	// createdAt: Client-declared timestamp when this post was originally created.
	CreatedAt string `json:"createdAt" cborgen:"createdAt"`
	// facets: Annotations of the caption (mentions, URLs)
	Facets []*RichtextFacet `json:"facets,omitempty" cborgen:"facets,omitempty"`
	// labels: Self-label values for this post. Effectively content warnings.
	Labels *FeedPost_Labels `json:"labels,omitempty" cborgen:"labels,omitempty"`
	Media  *FeedPost_Media  `json:"media" cborgen:"media"`
}

// Self-label values for this post. Effectively content warnings.
type FeedPost_Labels struct {
	LabelDefs_SelfLabels *comatproto.LabelDefs_SelfLabels
}

func (t *FeedPost_Labels) MarshalJSON() ([]byte, error) {
	if t.LabelDefs_SelfLabels != nil {
		t.LabelDefs_SelfLabels.LexiconTypeID = "com.atproto.label.defs#selfLabels"
		return json.Marshal(t.LabelDefs_SelfLabels)
	}
	return nil, fmt.Errorf("can not marshal empty union as JSON")
}

func (t *FeedPost_Labels) UnmarshalJSON(b []byte) error {
	typ, err := lexutil.TypeExtract(b)
	if err != nil {
		return err
	}

	switch typ {
	case "com.atproto.label.defs#selfLabels":
		t.LabelDefs_SelfLabels = new(comatproto.LabelDefs_SelfLabels)
		return json.Unmarshal(b, t.LabelDefs_SelfLabels)
	default:
		return nil
	}
}

func (t *FeedPost_Labels) MarshalCBOR(w io.Writer) error {

	if t == nil {
		_, err := w.Write(cbg.CborNull)
		return err
	}
	if t.LabelDefs_SelfLabels != nil {
		return t.LabelDefs_SelfLabels.MarshalCBOR(w)
	}
	return fmt.Errorf("can not marshal empty union as CBOR")
}

func (t *FeedPost_Labels) UnmarshalCBOR(r io.Reader) error {
	typ, b, err := lexutil.CborTypeExtractReader(r)
	if err != nil {
		return err
	}

	switch typ {
	case "com.atproto.label.defs#selfLabels":
		t.LabelDefs_SelfLabels = new(comatproto.LabelDefs_SelfLabels)
		return t.LabelDefs_SelfLabels.UnmarshalCBOR(bytes.NewReader(b))
	default:
		return nil
	}
}

type FeedPost_Media struct {
	MediaImages *MediaImages
}

func (t *FeedPost_Media) MarshalJSON() ([]byte, error) {
	if t.MediaImages != nil {
		t.MediaImages.LexiconTypeID = "app.vylet.media.images"
		return json.Marshal(t.MediaImages)
	}
	return nil, fmt.Errorf("can not marshal empty union as JSON")
}

func (t *FeedPost_Media) UnmarshalJSON(b []byte) error {
	typ, err := lexutil.TypeExtract(b)
	if err != nil {
		return err
	}

	switch typ {
	case "app.vylet.media.images":
		t.MediaImages = new(MediaImages)
		return json.Unmarshal(b, t.MediaImages)
	default:
		return nil
	}
}

func (t *FeedPost_Media) MarshalCBOR(w io.Writer) error {

	if t == nil {
		_, err := w.Write(cbg.CborNull)
		return err
	}
	if t.MediaImages != nil {
		return t.MediaImages.MarshalCBOR(w)
	}
	return fmt.Errorf("can not marshal empty union as CBOR")
}

func (t *FeedPost_Media) UnmarshalCBOR(r io.Reader) error {
	typ, b, err := lexutil.CborTypeExtractReader(r)
	if err != nil {
		return err
	}

	switch typ {
	case "app.vylet.media.images":
		t.MediaImages = new(MediaImages)
		return t.MediaImages.UnmarshalCBOR(bytes.NewReader(b))
	default:
		return nil
	}
}
